{
    "dataset_reader": {
        "class_name": "basic_classification_reader",
        "format": "json",
        "orient": "split",
        "x": "text",
        "y": "category",
        "data_path": "{DOWNLOADS_PATH}/clinc150_no_oos",
        "train": "train.json",
        "valid": "dev.json",
        "test": "test.json"
    },
    "dataset_iterator": {
        "class_name": "few_shot_iterator",
        "seed": 0,
        "shuffle": true,
        "shot": 5,
        "save_path": "{SUPPORT_DATA_PATH}/parsed_dataset.json",
        "return_nli_format": true
    },
    "chainer": {
        "in": [
            "premise",
            "hypothesis"
        ],
        "in_y": ["y_true_labels"],
        "pipe": [
            {
                "class_name": "torch_transformers_preprocessor",
                "in": [
                    "premise",
                    "hypothesis"
                ],
                "out": ["bert_features"],
                "vocab_file": "{BASE_MODEL}",
                "do_lower_case": false,
                "max_seq_length": 128
            },
            {
                "id": "classes_vocab",
                "class_name": "simple_vocab",
                "fit_on": ["y_true_labels"],
                "save_path": "{MODEL_PATH}/classes.dict",
                "load_path": "{MODEL_PATH}/classes.dict",
                "in": ["y_true_labels"],
                "out": ["y_true_ids"]
            },
            {
                "class_name": "torch_transformers_classifier",
                "n_classes": "#classes_vocab.len",
                "in": ["bert_features"],
                "in_y": ["y_true_ids"],
                "out": ["y_pred_probas"],
                "return_probas": true,
                "pretrained_bert": "{BASE_MODEL}",
                "save_path": "{MODEL_PATH}/model",
                "load_path": "{MODEL_PATH}/model",
                "is_binary": "{BINARY_CLASSIFICATION}",
                "optimizer": "AdamW",
                "optimizer_parameters": {
                    "lr": 2e-05
                }
            },
            {
                "class_name": "proba2labels",
                "in": ["y_pred_probas"],
                "out": ["y_pred_ids"],
                "max_proba": true
            },
            {
                "ref": "classes_vocab",
                "in": ["y_pred_ids"],
                "out": ["y_pred_labels"]
            }
        ],
        "out": ["y_pred_labels"]
    },
    "train": {
        "batch_size": 370,
        "epochs": 7,
        "log_every_n_epochs": 1,
        "val_every_n_epochs": 7,
        "validation_patience": -1,
        "validate_first": false,
        "metrics": [
            {
                "name": "accuracy_oos",
                "inputs": [
                    "y_true_labels",
                    "y_pred_labels"
                ]
            }
        ],
        "evaluation_targets": ["valid"],
        "class_name": "torch_trainer"
    },
    "metadata": {
        "variables": {
            "ROOT_PATH": "~/.deeppavlov",
            "DOWNLOADS_PATH": "{ROOT_PATH}/downloads",
            "SUPPORT_DATA_PATH": "{ROOT_PATH}/parsed_datasets",
            "MODELS_PATH": "{ROOT_PATH}/models",
            "MODEL_PATH": "{MODELS_PATH}/classification/roberta_nli_binary_finetune",
            "BASE_MODEL": "roberta-base",
            "BINARY_CLASSIFICATION": true
        },
        "download": [
            {
              "url": "http://files.deeppavlov.ai/v1/classifiers/fewshot/roberta_nli.tar.gz",
              "subdir": "{MODEL_PATH}"
            },
            {
                "url": "https://files.deeppavlov.ai/datasets/clinc150_no_oos.tar.gz",
                "subdir": "{DOWNLOADS_PATH}/clinc150_no_oos"
            }
        ]
    }
}
